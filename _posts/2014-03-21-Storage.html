---
layout: post
title: "Storage notes"
description: "关于存储性能的一些相关知识整理，主要包括性能方面。"
categories: [tech]
tags: [storage, performance]
---


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 硬盘IOPS</a></li>
<li><a href="#sec-2">2 RAID对IOPS影响</a></li>
<li><a href="#sec-3">3 Latency comparison</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">硬盘IOPS<sup><a class="footref" name="fnr-.1" href="#fn-.1">1</a></sup><sup>, </sup><sup><a class="footref" name="fnr-.2" href="#fn-.2">2</a></sup></h2>
<div class="outline-text-2" id="text-1">


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="right" /><col class="right" /><col class="left" /><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="right">size</th><th scope="col" class="right">RPM</th><th scope="col" class="left">Seek time</th><th scope="col" class="left">Avg Rota latency</th><th scope="col" class="left">Throught</th><th scope="col" class="left">Random IOPS</th></tr>
<tr><th scope="col" class="right"></th><th scope="col" class="right"></th><th scope="col" class="left"></th><th scope="col" class="left">0.5/(RPM/60)</th><th scope="col" class="left"></th><th scope="col" class="left">1/(seek+latency)</th></tr>
</thead>
<tbody>
<tr><td class="right">2.5</td><td class="right">15000</td><td class="left">4ms</td><td class="left">2ms</td><td class="left">6Gbps</td><td class="left">~175-210</td></tr>
<tr><td class="right">2.5</td><td class="right">10000</td><td class="left">4ms</td><td class="left">3ms</td><td class="left">6Gbps</td><td class="left">~175-210</td></tr>
<tr><td class="right">3.5</td><td class="right">15000</td><td class="left">8ms</td><td class="left">2ms</td><td class="left">6Gbps</td><td class="left">~140</td></tr>
<tr><td class="right">3.5</td><td class="right">10000</td><td class="left">8ms</td><td class="left">3ms</td><td class="left">6Gbps</td><td class="left">~140</td></tr>
<tr><td class="right">2.5</td><td class="right">7200</td><td class="left">10ms</td><td class="left">4ms</td><td class="left">3Gbps</td><td class="left">~75-100</td></tr>
</tbody>
</table>


</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">RAID对IOPS影响<sup><a class="footref" name="fnr-.3" href="#fn-.3">3</a></sup><sup>, </sup><sup><a class="footref" name="fnr-.4" href="#fn-.4">4</a></sup><sup>, </sup><sup><a class="footref" name="fnr-.5" href="#fn-.5">5</a></sup></h2>
<div class="outline-text-2" id="text-2">


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="right" /><col class="right" /><col class="right" />
</colgroup>
<thead>
<tr><th scope="col" class="right">RAID Level</th><th scope="col" class="right">Read</th><th scope="col" class="right">write</th></tr>
</thead>
<tbody>
<tr><td class="right">0</td><td class="right">1</td><td class="right">1</td></tr>
<tr><td class="right">1 / 10</td><td class="right">1</td><td class="right">2</td></tr>
<tr><td class="right">5</td><td class="right">1</td><td class="right">4</td></tr>
<tr><td class="right">6</td><td class="right">1</td><td class="right">6</td></tr>
</tbody>
</table>

参照上表，一个raid6的存储，一个写请求需要消耗6个IOPS，简单计算一下，如果你需要
一个250IOPS的存储，一半读一半写，那就意味着你需要准备(250*50% + 250*50%*6)=875
的IOPS存储。

</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Latency comparison<sup><a class="footref" name="fnr-.6" href="#fn-.6">6</a></sup></h2>
<div class="outline-text-2" id="text-3">





<pre class="example">L1 cache reference                            0.5 ns
Branch mispredict                             5   ns
L2 cache reference                            7   ns             14x L1 cache
Mutex lock/unlock                            25   ns
Main memory reference                       100   ns             20x L2 cache, 200x L1 cache
Compress 1K bytes with Zippy              3,000   ns
Send 1K bytes over 1 Gbps network        10,000   ns    0.01 ms
Read 4K randomly from SSD*              150,000   ns    0.15 ms
Read 1 MB sequentially from memory      250,000   ns    0.25 ms
Round trip within same datacenter       500,000   ns    0.5  ms
Read 1 MB sequentially from SSD*      1,000,000   ns    1    ms  4X memory
Disk seek                            10,000,000   ns   10    ms  20x datacenter roundtrip
Read 1 MB sequentially from disk     20,000,000   ns   20    ms  80x memory, 20X SSD
Send packet CA-&gt;Netherlands-&gt;CA     150,000,000   ns  150    ms
</pre>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">
<p class="footnote"><sup><a class="footnum" name="fn-.1" href="#fnr-.1">1</a></sup> <a href="http://en.wikipedia.org/wiki/IOPS">Wiki IOPS</a>
</p>


<p class="footnote"><sup><a class="footnum" name="fn-.2" href="#fnr-.2">2</a></sup> <a href="http://www.csee.umbc.edu/~olano/611s06/storage-io.pdf">Storage IO</a>
</p>


<p class="footnote"><sup><a class="footnum" name="fn-.3" href="#fnr-.3">3</a></sup> <a href="http://www.techrepublic.com/blog/the-enterprise-cloud/calculate-iops-in-a-storage-array/">Calculate IOPS in a storage array</a>
</p>


<p class="footnote"><sup><a class="footnum" name="fn-.4" href="#fnr-.4">4</a></sup> <a href="http://www.yellow-bricks.com/2009/12/23/iops/">IOPS</a>
</p>


<p class="footnote"><sup><a class="footnum" name="fn-.5" href="#fnr-.5">5</a></sup> <a href="http://www.wmarow.com/strcalc/">IOPS Calculator</a>
</p>


<p class="footnote"><sup><a class="footnum" name="fn-.6" href="#fnr-.6">6</a></sup> <a href="https://gist.github.com/jboner/2841832">Latency Numbers Every Programmer Should Know</a>
</p>


</div>
</div>

</div>
</div>
