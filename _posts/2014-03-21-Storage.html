---
layout: post
title: "Storage notes"
description: "关于存储性能的一些相关知识整理，主要包括性能方面。"
categories: [tech]
tags: [storage, performance]
---

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 硬盘IOPS<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup><sup>, </sup><sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup></h2>
<div class="outline-text-2" id="text-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">size</th>
<th scope="col" class="right">RPM</th>
<th scope="col" class="left">Seek time</th>
<th scope="col" class="left">Avg Rota latency</th>
<th scope="col" class="left">Throught</th>
<th scope="col" class="left">Random IOPS</th>
</tr>

<tr>
<th scope="col" class="right">&#xa0;</th>
<th scope="col" class="right">&#xa0;</th>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">0.5/(RPM/60)</th>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">1/(seek+latency)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">2.5</td>
<td class="right">15000</td>
<td class="left">4ms</td>
<td class="left">2ms</td>
<td class="left">6Gbps</td>
<td class="left">~175-210</td>
</tr>

<tr>
<td class="right">2.5</td>
<td class="right">10000</td>
<td class="left">4ms</td>
<td class="left">3ms</td>
<td class="left">6Gbps</td>
<td class="left">~175-210</td>
</tr>

<tr>
<td class="right">3.5</td>
<td class="right">15000</td>
<td class="left">8ms</td>
<td class="left">2ms</td>
<td class="left">6Gbps</td>
<td class="left">~140</td>
</tr>

<tr>
<td class="right">3.5</td>
<td class="right">10000</td>
<td class="left">8ms</td>
<td class="left">3ms</td>
<td class="left">6Gbps</td>
<td class="left">~140</td>
</tr>

<tr>
<td class="right">2.5</td>
<td class="right">7200</td>
<td class="left">10ms</td>
<td class="left">4ms</td>
<td class="left">3Gbps</td>
<td class="left">~75-100</td>
</tr>

<tr>
<td class="right">&#xa0;</td>
<td class="right">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> RAID对IOPS影响<sup><a id="fnr.3" name="fnr.3" class="footref" href="#fn.3">3</a></sup><sup>, </sup><sup><a id="fnr.4" name="fnr.4" class="footref" href="#fn.4">4</a></sup><sup>, </sup><sup><a id="fnr.5" name="fnr.5" class="footref" href="#fn.5">5</a></sup></h2>
<div class="outline-text-2" id="text-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">RAID Level</th>
<th scope="col" class="right">Read</th>
<th scope="col" class="right">write</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0</td>
<td class="right">1</td>
<td class="right">1</td>
</tr>

<tr>
<td class="right">1 / 10</td>
<td class="right">1</td>
<td class="right">2</td>
</tr>

<tr>
<td class="right">5</td>
<td class="right">1</td>
<td class="right">4</td>
</tr>

<tr>
<td class="right">6</td>
<td class="right">1</td>
<td class="right">6</td>
</tr>
</tbody>
</table>
<p>
参照上表，一个raid6的存储，一个写请求需要消耗6个IOPS，简单计算一下，如果你需要
一个250IOPS的存储，一半读一半写，那就意味着你需要准备(250*50% + 250*50%*6)=875
的IOPS存储。
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Latency comparison<sup><a id="fnr.6" name="fnr.6" class="footref" href="#fn.6">6</a></sup></h2>
<div class="outline-text-2" id="text-3">
<pre class="example">
L1 cache reference                            0.5 ns
Branch mispredict                             5   ns
L2 cache reference                            7   ns             14x L1 cache
Mutex lock/unlock                            25   ns
Main memory reference                       100   ns             20x L2 cache, 200x L1 cache
Compress 1K bytes with Zippy              3,000   ns
Send 1K bytes over 1 Gbps network        10,000   ns    0.01 ms
Read 4K randomly from SSD*              150,000   ns    0.15 ms
Read 1 MB sequentially from memory      250,000   ns    0.25 ms
Round trip within same datacenter       500,000   ns    0.5  ms
Read 1 MB sequentially from SSD*      1,000,000   ns    1    ms  4X memory
Disk seek                            10,000,000   ns   10    ms  20x datacenter roundtrip
Read 1 MB sequentially from disk     20,000,000   ns   20    ms  80x memory, 20X SSD
Send packet CA-&gt;Netherlands-&gt;CA     150,000,000   ns  150    ms
</pre>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://en.wikipedia.org/wiki/IOPS">Wiki IOPS</a>
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://www.csee.umbc.edu/~olano/611s06/storage-io.pdf">Storage IO</a>
</p></div>

<div class="footdef"><sup><a id="fn.3" name="fn.3" class="footnum" href="#fnr.3">3</a></sup> <p class="footpara">
<a href="http://www.techrepublic.com/blog/the-enterprise-cloud/calculate-iops-in-a-storage-array/">Calculate IOPS in a storage array</a>
</p></div>

<div class="footdef"><sup><a id="fn.4" name="fn.4" class="footnum" href="#fnr.4">4</a></sup> <p class="footpara">
<a href="http://www.yellow-bricks.com/2009/12/23/iops/">IOPS</a>
</p></div>

<div class="footdef"><sup><a id="fn.5" name="fn.5" class="footnum" href="#fnr.5">5</a></sup> <p class="footpara">
<a href="http://www.wmarow.com/strcalc/">IOPS Calculator</a>
</p></div>

<div class="footdef"><sup><a id="fn.6" name="fn.6" class="footnum" href="#fnr.6">6</a></sup> <p class="footpara">
<a href="https://gist.github.com/jboner/2841832">Latency Numbers Every Programmer Should Know</a>
</p></div>


</div>
</div>
